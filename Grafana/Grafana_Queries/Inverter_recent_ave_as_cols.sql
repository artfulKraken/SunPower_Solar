SELECT
  IFNULL( AVG( CASE WHEN serial = 'E00122250068485' THEN p_3phsum_kw ELSE NULL END ), 0 ) AS `E00122250068485 Power`,
  IFNULL( AVG( CASE WHEN serial = 'E00122250068512' THEN p_3phsum_kw ELSE NULL END ), 0 ) AS `E00122250068512 Power`,
  IFNULL( AVG( CASE WHEN serial = 'E00122250068516' THEN p_3phsum_kw ELSE NULL END ), 0 ) AS `E00122250068516 Power`,
  IFNULL( AVG( CASE WHEN serial = 'E00122250068698' THEN p_3phsum_kw ELSE NULL END ), 0 ) AS `E00122250068698 Power`,
  IFNULL( AVG( CASE WHEN serial = 'E00122250068758' THEN p_3phsum_kw ELSE NULL END ), 0 ) AS `E00122250068758 Power`,
  IFNULL( AVG( CASE WHEN serial = 'E00122250068774' THEN p_3phsum_kw ELSE NULL END ), 0 ) AS `E00122250068774 Power`,
  IFNULL( AVG( CASE WHEN serial = 'E00122250068776' THEN p_3phsum_kw ELSE NULL END ), 0 ) AS `E00122250068776 Power`,
  IFNULL( AVG( CASE WHEN serial = 'E00122250068780' THEN p_3phsum_kw ELSE NULL END ), 0 ) AS `E00122250068780 Power`,
  IFNULL( AVG( CASE WHEN serial = 'E00122250068886' THEN p_3phsum_kw ELSE NULL END ), 0 ) AS `E00122250068886 Power`,
  IFNULL( AVG( CASE WHEN serial = 'E00122250068916' THEN p_3phsum_kw ELSE NULL END ), 0 ) AS `E00122250068916 Power`,
  IFNULL( AVG( CASE WHEN serial = 'E00122250068917' THEN p_3phsum_kw ELSE NULL END ), 0 ) AS `E00122250068917 Power`,
  IFNULL( AVG( CASE WHEN serial = 'E00122250068994' THEN p_3phsum_kw ELSE NULL END ), 0 ) AS `E00122250068994 Power`,
  IFNULL( AVG( CASE WHEN serial = 'E00122250071017' THEN p_3phsum_kw ELSE NULL END ), 0 ) AS `E00122250071017 Power`,
  IFNULL( AVG( CASE WHEN serial = 'E00122250071869' THEN p_3phsum_kw ELSE NULL END ), 0 ) AS `E00122250071869 Power`,
  IFNULL( AVG( CASE WHEN serial = 'E00122250077989' THEN p_3phsum_kw ELSE NULL END ), 0 ) AS `E00122250077989 Power`,
  IFNULL( AVG( CASE WHEN serial = 'E00122250081238' THEN p_3phsum_kw ELSE NULL END ), 0 ) AS `E00122250081238 Power`,
  IFNULL( AVG( CASE WHEN serial = 'E00122250084153' THEN p_3phsum_kw ELSE NULL END ), 0 ) AS `E00122250084153 Power`,
  IFNULL( AVG( CASE WHEN serial = 'E00122250084256' THEN p_3phsum_kw ELSE NULL END ), 0 ) AS `E00122250084256 Power`,
  IFNULL( AVG( CASE WHEN serial = 'E00122251002917' THEN p_3phsum_kw ELSE NULL END ), 0 ) AS `E00122251002917 Power`,
  IFNULL( AVG( CASE WHEN serial = 'E00122251005754' THEN p_3phsum_kw ELSE NULL END ), 0 ) AS `E00122251005754 Power`,
  IFNULL( AVG( CASE WHEN serial = 'E00122251010882' THEN p_3phsum_kw ELSE NULL END ), 0 ) AS `E00122251010882 Power`,
  IFNULL( AVG( CASE WHEN serial = 'E00122251011493' THEN p_3phsum_kw ELSE NULL END ), 0 ) AS `E00122251011493 Power`,
  IFNULL( AVG( CASE WHEN serial = 'E00122251011515' THEN p_3phsum_kw ELSE NULL END ), 0 ) AS `E00122251011515 Power`,
  IFNULL( AVG( CASE WHEN serial = 'E00122251015947' THEN p_3phsum_kw ELSE NULL END ), 0 ) AS `E00122251015947 Power`,
  IFNULL( AVG( CASE WHEN serial = 'E00122251016232' THEN p_3phsum_kw ELSE NULL END ), 0 ) AS `E00122251016232 Power`
FROM
  inverters_data
WHERE
  data_time >= DATE_ADD( now(), INTERVAL -30 MINUTE )
ORDER BY data_time DESC
LIMIT 1;
